machine:
  Version: 
    ubuntu-14.04-XXL-1167-271bbe4
  python:
    version: 3.5.0
  services:
    - docker


dependencies:
  pre:
    - bash <(wget -q -O- http://neuro.debian.net/_files/neurodebian-travis.sh)
    - sudo apt-get -y update
    - sudo apt-get install git-annex-standalone

  override:
    - pip install --upgrade pip
    - pip install datalad
    - pip install pytest

    - pip install https://github.com/kaczmarj/neurodocker/archive/master.tar.gz
    - neurodocker -b centos:7 -p yum --miniconda python_version=3.5.1 conda_install=traits,pandas,pytest pip_install=nipype --no-check-urls --no-print-df -o Dockerfile_test
    - docker build -f Dockerfile_test -t myimage_test .

test:

  override:
    - git fetch origin git-annex:git-annex
    #git-annex
    - git annex init
    - git annex enableremote cloud5
    - git annex get

    - docker run -it -v $PWD:/home myimage_test pytest /home/test.py
    #- python -m datalad `which pytest` test.py